# Описание проекта
## О проекте
Проект выполнен в качестве итогового задания по курсу Аналитик данных (Data scientist) в 2022 году
## Описание решения
Описание проекта ссодержится в блокноте 
notebook/eda/TaskDescription.ipynb или статье 
static/TaskDescription.pdf

## Описание программы и проекта
### Общее описание
В программе реализована функция прогнозирования глубины и ширины сварного шва композитных материалов. 
Прогнозирование осуществлется с использованием моделей линейной регрессии и полносвязной нейронной сети.

Для решения задачи реализована два класса: 
  - LinearRegression -для работы с линейной регрессией с использованием методов библиотеки sklean
  - MLPRegression - для работы с нейронной сетью с использование keras

Классы содержат методы для обучения моделей (fit), выполнения прогноза (predict) и проверка диапазона входных значений. 
Для обучения по-умолчанию используется файл data/raw/ebw_data.csv.
Обученная модель сохраняется в файлах:
  - lr_model -  для модели линейной регрессии 
  - model/MLP_model.hd5 - для нейронной сети

Доступ к работе с моделям возможен через интерфейс командной строки или через Web. Обучение модели доступно только через интерфейс командной строки.

Дополнительно использования классов сделаем реализацию для командной строки и web интерфейс с использованием flask. 

### Требования к библиотекам
Для использования приложения необходимы следующие библиотеки
  - tensorflow 2.10.0
  - keras
  - flask 2.2.2
  - numpy
  - pandas
  - scikit-learn

### Описание проекта
Исходный код приложения организован в проект PyCharm. 
Структура проекта:
````
-tProject
    -data
        -raw
            -ebw_data.csv - файл с исходными данными для обучения моделей
    -model
        -tmp
        -MLP_model.h5 - обученная модель нейросети
    -notebook
        -eda
            -TaskDescription.ipynb - блокнот с обоснованием и описанием решения
    -src
        -modeling
            -LinearRegression.py - класс для использования линейной регрессии
            -MLPRegression.py - класс для использования нейросети
    -static - статические файлы для оформления web приложения
        -css
        -js
        -TaskDescription.pdf
    -template
        -start.html - Jinja2 шаблон для страницы WEB приложения
    -flask_backend.py - WEB приложение
    -lr_model - обученная модель линейной регрессии
    -main.py - интерфейс коммандной строки
    -README.md
````

### Интерфейс командной строки
Параметры вызова командной строки:

__main.py__ __-method__ _метод расчета_ __-mode__ _режим работы_ __-data_file_path__ _имя файла с данными для обучения модели_
    
    -method - принимает два значения LinearRegression и MLPRegression, по-умолчанию - LinearRegression
    -mode - принимает два значения fit и predict, по умолчанию predict. Данные обученных моделей сохранябтся на диске ('lr_model' и 'MLP_model' соответственно) 
    -data_file_path - путь к файлу с данными  для переобучения модели, по умолчанию ./data/raw/ebw_data.csv

### WEB приложение
Вызов __web приложения__:
flask --app flask_backend run

После запуска flask в браузере открыть страницу http://127.0.0.1:5000/

Использование tensorflow из flask иногда может потребовать дополнительных настроек. При вызове ограничивается объем видеопамяти, используемой tensorflow. 